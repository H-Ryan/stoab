<!DOCTYPE HTML><html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
       
        <link rel="stylesheet" type="text/css" href="css/style.css" />
		
<style type="text/css"> 

BODY,FONT { 
font-family:arial,tahoma,verdana,helvetica; font-size:16px;
}
STRONG{
color: #381E05;
font-family: arial, verdana;
font-size: 19px;
}
div.online {
	position:absolute;
	left:970px;
	top:82px;
	width:200px;
	height:120px;
                  z-index: 30;
}
.btn {   
color:#fff;   
font-size: 21px ;
font-family: arial,helvetica,sans-serif;   
background-color:#2D1101;   
border: 2px solid;   
border-color: #ffffff #B0A18F #B0A18F #ffffff;   
padding:15px;
border-radius:10px;
} 
.ff{
color: #2D1101; font-size: 14px; font-family: arial,Tahoma, Helvetica, sans-serif;
border:1px solid #2D1101;
padding:10px;
margin:4px;

}

.menyn { 
font-family:arial,tahoma,verdana,helvetica; font-size:17px;
color:#4A392B;
}
.brod2 { 
font-family:arial,tahoma,verdana,helvetica; font-size:14px;
color:#8C6D5E;
}
.brod3 { 
text-align:center;
font-family:arial,tahoma,verdana,helvetica; font-size:16px;
color:#311D12;
}
.brod6 { 
text-align:center;
font-family:arial,tahoma,verdana,helvetica; font-size:19px;
color:#C8B9A6;
}

a {text-decoration: none;} 


#titel{font-family:"Old Script"; font-size:61px; color:#8C6D5E;}
#titel2{font-family:"Old Script"; font-size:41px; color:#BC9E90;}
img {
   display: block;
}

a{ color:#FFCC33;}
.main-width
{
position: relative;
top:-20px;
left:225px;
	width: 560px;
	margin: 0 auto;
z-index:100;
}

header
{
  display: block;  
  padding: 10px 0;
  overflow: hidden;
}

#logo
{
	float: left;
	margin: 0;
}

#logo a
{
	font: bold 30px/1 'Sigmar One', Verdana, Arial;
	color: #f1f1f1;
	text-shadow: 0 3px 0 #333;
	text-decoration: none;
	text-transform: uppercase;
}

#logo a span
{
	color: #ddd;
}


nav
{
	float: right;
}

nav ul
{
	padding: 0;
	margin: 0;
	list-style: none;  	
}

nav li
{
	float: left;
}

nav a
{
	float: left;
    color: #eee;
    margin: 0 5px;
    padding: 3px;
    text-decoration: none;
	border: 1px solid #6D4837;
	font: bold 14px Arial, Helvetica; 	
    background-color: #6D4837;
    background-image: -moz-linear-gradient(#A07152, #6D4837);
    background-image: -webkit-gradient(linear, left top, left bottom, from(#A07152), to(#6D4837));    
    background-image: -webkit-linear-gradient(#A07152, #6D4837);
    background-image: -o-linear-gradient(#A07152, #6D4837);
    background-image: -ms-linear-gradient(#A07152, #6D4837);
    background-image: linear-gradient(#A07152, #6D4837);
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
    text-shadow: 0 -1px 0 rgba(0,0,0,.8);    
    -moz-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.3), 0 3px 0 rgba(0, 0, 0, 0.7), 0 2px 2px rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.5) inset;
    -webkit-box-shadow: 0 1px 0 rgba(255, 255, 255, 0.3), 0 3px 0 rgba(0, 0, 0, 0.7), 0 2px 2px rgba(0, 0, 0, 0.5), 0 1px 0 rgba(255, 255, 255, 0.5) inset;
    
}

nav a:hover
{
    background-color: #A07152;
    background-image: -moz-linear-gradient(#6D4837, #A07152);
    background-image: -webkit-gradient(linear, left top, left bottom, from(#6D4837), to(#A07152));      
    background-image: -webkit-linear-gradient(#6D4837, #A07152);
    background-image: -o-linear-gradient(#6D4837, #A07152);
    background-image: -ms-linear-gradient(#6D4837, #A07152);
    background-image: linear-gradient(#6D4837, #A07152);
}

nav a:active
{
    background: #A07152;
    position: relative;
    top: 2px;    
    -moz-box-shadow: 0 0 3px rgba(0, 0, 0, 0.7) inset;
    -webkit-box-shadow: 0 0 3px rgba(0, 0, 0, 0.7) inset;
    box-shadow: 0 0 3px rgba(0, 0, 0, 0.7) inset; 
}

nav span
{
	border: 1px dashed #eba1a3;
    display: inline-block;
    padding: 4px 15px;
	cursor: pointer;	
    background-color: #A07152;
    background-image: -moz-linear-gradient(#B57356, #8B613B);
    background-image: -webkit-gradient(linear, left top, left bottom, from(#B57356), to(#8B613B));      
    background-image: -webkit-linear-gradient(#B57356, #8B613B);
    background-image: -o-linear-gradient(#B57356, #8B613B);
    background-image: -ms-linear-gradient(#B57356, #8B613B);
    background-image: linear-gradient(#B57356, #8B613B);
}

nav a:hover span
{	
    background-color: #A07152;
    background-image: -moz-linear-gradient(#8B613B, #B57356);
    background-image: -webkit-gradient(linear, left top, left bottom, from(#8B613B), to(#B57356));      
    background-image: -webkit-linear-gradient(#8B613B, #B57356);
    background-image: -o-linear-gradient(#8B613B, #B57356);
    background-image: -ms-linear-gradient(#8B613B, #B57356);
    background-image: linear-gradient(#8B613B, #B57356);
}
</style>
</head>
<body bgcolor="#cccccc" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
<div align=center><br><table width=1100 border=0 style="background-color:#cccccc; border: 2px solid;border-color: #ffffff #B0A18F #B0A18F #ffffff;   padding:15px;border-radius:10px;">

<?php

// strip slashes
if (get_magic_quotes_gpc()) {
  function stripslashes_deep($value) {
    $value = is_array($value) ? array_map('stripslashes_deep', $value) : (isset($value) ? stripslashes($value) : null);
    return $value;
  }

  $_POST = stripslashes_deep($_POST);
  $_GET = stripslashes_deep($_GET);
  //$_COOKIE = stripslashes_deep($_COOKIE);
}

$structure_tmp = file($structure_file);
$structure = array();
foreach($structure_tmp as $key=>$tmp) {
  /*if(strpos($tmp,':') === 0) {
    $code = explode(':',$tmp);
    ${$code[1]} = trim($code[2]);
    continue;
  }*/
  $line = explode(',',$tmp);
  $name_will_be = str_replace(' ','',trim($line[0]));
  foreach($structure as $key1=>$value1) {
    if ($value1['name'] == $name_will_be)
      die("Few columns have the similar name (not counting spaces): '{$line[0]}'. Please rename.");
  }
  $structure[$key]['name_original'] = trim($line[0]);
  $structure[$key]['name'] = str_replace(' ','',$structure[$key]['name_original']);
  $structure[$key]['type'] = trim($line[1]);
  if (isset($line[2])) $structure[$key]['format'] = trim($line[2]);
  if (isset($line[3])) {
    $values = explode(':',$line[3]);
    foreach($values as $item) {
      $structure[$key]['values'][] = trim($item);
    }
  }
}

// Save data (Submit button pressed)
if (isset($_POST['submit'])) {
  /////////////////////////////////////////////////

  if ($skip_lines > 0) {
    // read header lines
    $tmp_data = file($data_file);
  }

  $f = fopen($data_file,'w+');
  if ($f) {

    // save header back to file
    if ($skip_lines > 0) {
      for($i=0; $i < $skip_lines; $i++) {
        fputs($f,$tmp_data[$i]);
      }
    }

    for( $i=0; $i < count($_POST[$structure[0]['name']]); $i++ ) {
      // do not save records marked for delete
      if (isset($_POST['d_e_l_e_t_e'][$i])) continue;

      $s = '';
      $isfirst = true;
      foreach($structure as $key => $field) {
        $n1 = isset($_POST[$structure[$key]['name']]) ? $_POST[$structure[$key]['name']] : '';
        $v1 = isset($n1[$i]) ? $n1[$i] : $structure[$key]['values'][1];
        // remove new line characters as each new line represents new database row
        $v1 = str_replace(array("\r\n","\n","\r"),'',$v1);
        $s = $s . ($isfirst ? '' : $delimiter) . $v1;
        $isfirst = false;
      }
      // do not save empty lines
      if (trim(str_replace($delimiter,'',$s)) == '') continue;

      // save database record to file
      fputs($f,$s."\n");
    } // for
    fclose($f);
  } // if
}

$data = file($data_file);

// skip header lines
if ($skip_lines > 0) $data = array_slice($data, $skip_lines);

// add "new line" holder
$data[] = str_repeat($delimiter,count($structure)-1);

echo '<form method="post"><tr>';

// output header
foreach ($structure as $key=>$line) {
}


// output data
foreach($data as $datakey => $line) {

  // skip empty rows
  if (trim($line) == '') continue;

  $items = explode($delimiter,$line);

  // any fields not defined? add empty
  while (count($items) < count($structure))
    $items[] = '';
  foreach ($items as $key => $item) {
    $item = htmlspecialchars(trim($item));
    $name = $structure[$key]['name'];
    echo "\n".'';

    switch ($structure[$key]['type']) {
      case 'STRING':
        echo '<td><input onchange="cdf('.$datakey.')" class=ff name="'.$name.'['.$datakey.']" value="'.$item.'" size="'.$structure[$key]['format'].'" /></td>';
        break;
      case 'TEXT':
       echo '<td><input onchange="cdf('.$datakey.')" class=ff name="'.$name.'['.$datakey.']" value="'.$item.'" size="'.$structure[$key]['format'].'"/></td>';
        break;
      case 'LOGICAL':
        $val_yes = trim($structure[$key]['values'][0]);
        echo '<input onchange="cdf('.$datakey.')" name="'.$name.'['.$datakey.']" type="checkbox" '.(($item == $val_yes) ? 'checked' : '').' value="'.$val_yes.'" />';
        break;
      case 'LIST':
        echo '<select onchange="cdf('.$datakey.')" name="'.$name.'['.$datakey.']" size="'.$structure[$key]['format'].'">';
        foreach($structure[$key]['values'] as $value) {
          echo '<option value="'.$value.'" '.($value == $item ? 'selected' : '').'>'.$value.'</option>';
        }
        echo '</select>';
        break;
    }
  }
  echo '</tr><tr>';
  //echo "\n  <br><input id='d_e_l_e_t_e[{$datakey}]'  name='d_e_l_e_t_e[{$datakey}]' type='checkbox' ".($datakey == count($data)-1 ? 'checked' : '')." />&nbsp; Radera<br>";

}

echo '<td colspan=4><br><input type="submit" name="submit" class=btn value="Spara">';
echo "</td></tr></form></table>

<script>
function cdf(theid) {
document.getElementById('d_e_l_e_t_e['+theid+']').checked = false;
}
</script>";

?>
</body>
</html>